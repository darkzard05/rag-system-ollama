# config.yml
# 애플리케이션의 주요 설정을 관리하는 파일입니다.

# --- 모델 설정 ---
models:
  # 기본으로 사용할 Ollama 모델 이름
  default_ollama: "gemma3:8b"
  
  # Ollama 모델의 토큰 생성 제한 (기본값: 2048)
  ollama_num_predict: 2048

  # Ollama 모델의 온도 설정 (기본값: 0.1)
  temperature: 0.1

  # Ollama 모델의 컨텍스트 윈도우 설정 (기본값: 4096)
  num_ctx: 4096

  # Ollama 모델의 탑-피 설정 (기본값: 0.8)
  top_p: 0.8

  # 사용 가능한 임베딩 모델 목록
  available_embeddings:
    - "sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2"
    - "intfloat/multilingual-e5-large-instruct"
    - "sentence-transformers/paraphrase-multilingual-mpnet-base-v2"
    - "sentence-transformers/all-MiniLM-L6-v2"
  
  # 모델 캐시 디렉터리
  cache_dir: ".model_cache"

  # 임베딩 모델의 배치 크기 ('auto'로 설정 시 VRAM에 따라 자동 조절, 숫자로 직접 지정 가능)
  embedding_batch_size: "auto"

# --- RAG 파이프라인 설정 ---
rag:
  # 벡터 저장소 캐시 디렉터리
  vector_store_cache_dir: ".model_cache/vector_store_cache"
  
  # 리트리버 설정
  retriever:
    search_type: "similarity"
    search_kwargs:
      k: 5
    # BM25와 FAISS의 가중치 (Ensemble Retriever용)
    ensemble_weights: [0.4, 0.6]

  # 텍스트 분할 설정
  text_splitter:
    chunk_size: 500
    chunk_overlap: 100
  
  # 의미론적 분할 설정 (임베딩 기반)
  semantic_chunker:
    enabled: true
    breakpoint_threshold_type: "percentile"  # 'percentile' 또는 'standard_deviation'
    breakpoint_threshold_value: 95  # 백분위수 95% (상위 5% 차이 지점에서 분할)
    sentence_split_regex: "[.!?]\\s+"  # 문장 분할 정규식
    min_chunk_size: 100  # 최소 청크 크기
    max_chunk_size: 800  # 최대 청크 크기
    similarity_threshold: 0.5  # 임베딩 유사도 threshold (0-1)

  # 프롬프트 설정
  prompts:
    qa_system_prompt: |
      당신은 도움이 되는 AI 어시스턴트입니다.
      제공된 참고 문서를 활용하여 사용자의 질문에 답변하세요.
      답변은 자연스럽고 이해하기 쉬워야 합니다.

# --- 채팅 UI 설정 ---
ui:
  # 채팅 및 PDF 뷰어 컨테이너의 높이
  container_height: 500
  
  # UI에 표시될 메시지
  messages:
    # --- 일반 메시지 ---
    preparing_answer: "답변 생성 준비 중..."
    thinking: "🤔 생각을 정리하는 중입니다..."
    no_thought_process: "아직 생각 과정이 없습니다."
    no_related_info: |
      제공된 문서에서 질문에 대한 명확한 정보를 찾기 어렵습니다. 😥

      **다음을 시도해 보세요:**
      - 질문을 좀 더 명확하게 하거나 다른 키워드를 사용해 보세요.
      - 좀 더 일반적이거나 넓은 범위의 질문을 해보세요.

    # --- 사이드바 ---
    sidebar_title: "⚙️ 설정"
    pdf_uploader_label: "PDF 파일 업로드"
    model_selector_label: "LLM 모델 선택"
    embedding_selector_label: "임베딩 모델 선택"
    system_status_title: "📊 시스템 상태"
    loading_models: "LLM 모델 목록을 불러오는 중..."

    # --- PDF 뷰어 ---
    pdf_viewer_title: "📄 PDF 미리보기"
    pdf_viewer_no_file: "미리볼 PDF가 없습니다. 사이드바에서 파일을 업로드해주세요."
    pdf_viewer_prev_button: "← 이전"
    pdf_viewer_next_button: "다음 →"
    pdf_viewer_page_slider: "페이지 이동"
    pdf_viewer_error: "PDF를 표시하는 중 오류가 발생했습니다: {e}"

    # --- 채팅 ---
    chat_title: "💬 채팅"
    chat_input_placeholder: "PDF 내용에 대해 질문해보세요."
    chat_no_qa_system: "QA 시스템이 준비되지 않았습니다. PDF를 먼저 처리해주세요."
    chat_welcome: |
      **RAG-Chat에 오신 것을 환영합니다!**

      사이드바에서 PDF 파일을 업로드하여 문서 내용에 대한 대화를 시작해보세요.
    chat_guide: |
      **💡 사용 가이드**
      - **PDF 업로드:** 좌측 사이드바에서 분석하고 싶은 PDF를 업로드하세요.
      - **모델 선택:** 로컬 `Ollama` 모델을 선택할 수 있습니다.
      - **질문하기:** 문서 처리가 완료되면, 내용에 대해 자유롭게 질문할 수 있습니다.
      - **PDF 뷰어:** 우측에서 원본 문서를 함께 보며 대화할 수 있습니다.
      
      **⚠️ 알아두실 점**
      - **답변의 정확성:** 답변은 업로드된 PDF 내용만을 기반으로 생성되며, 사실이 아닐 수 있습니다.
      - **초기 로딩:** 임베딩 모델을 처음 사용하면 다운로드에 몇 분이 소요될 수 있습니다.
    
    # --- 오류 및 상태 메시지 ---
    streaming_error: "스트리밍 답변 생성 중 오류 발생: {e}"
    generic_error: "오류가 발생했습니다: {error_msg}"
    retry_button: "재시도"
    errors:
      ollama_not_running: "Ollama 서버에 연결할 수 없습니다. 서버가 실행 중인지 확인해주세요."
