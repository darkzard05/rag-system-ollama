# config.yml
# ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ì£¼ìš” ì„¤ì •ì„ ê´€ë¦¬í•˜ëŠ” íŒŒì¼ì…ë‹ˆë‹¤.

# --- ëª¨ë¸ ì„¤ì • ---
models:
  # ê¸°ë³¸ìœ¼ë¡œ ì‚¬ìš©í•  Ollama ëª¨ë¸ ì´ë¦„
  default_ollama: "qwen3:4b-instruct-2507-q4_K_M"
  
  # Ollama ì„œë²„ ì£¼ì†Œ (ë¡œì»¬: http://127.0.0.1:11434, ë„ì»¤: http://host.docker.internal:11434)
  base_url: "http://127.0.0.1:11434"

  # Ollama ëª¨ë¸ì˜ í† í° ìƒì„± ì œí•œ (ê¸°ë³¸ê°’: 4096)
  # -1ë¡œ ì„¤ì •í•˜ë©´ ëª¨ë¸ì˜ ê¸°ë³¸ ì„¤ì • ë˜ëŠ” ë¬´ì œí•œ(ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš°ê¹Œì§€)ìœ¼ë¡œ ìƒì„±í•©ë‹ˆë‹¤.
  ollama_num_predict: -1

  # Ollama ëª¨ë¸ì˜ ì˜¨ë„ ì„¤ì •
  temperature: 0.1

  # Ollama ëª¨ë¸ì˜ ì»¨í…ìŠ¤íŠ¸ ìœˆë„ìš° ì„¤ì •
  num_ctx: 4096

  # Ollama ëª¨ë¸ì˜ íƒ‘-í”¼ ì„¤ì •
  top_p: 0.8

  # ì‚¬ìš© ê°€ëŠ¥í•œ ì„ë² ë”© ëª¨ë¸ ëª©ë¡
  available_embeddings:
    - "sentence-transformers/paraphrase-multilingual-MiniLM-L12-v2"
    - "intfloat/multilingual-e5-large-instruct"
    - "sentence-transformers/paraphrase-multilingual-mpnet-base-v2"
    - "sentence-transformers/all-MiniLM-L6-v2"
  
  # ëª¨ë¸ ìºì‹œ ë””ë ‰í„°ë¦¬
  cache_dir: ".model_cache"

  # ì„ë² ë”© ëª¨ë¸ì˜ ë°°ì¹˜ í¬ê¸°
  embedding_batch_size: "auto"

  # ì„ë² ë”© ëª¨ë¸ ì‹¤í–‰ ë””ë°”ì´ìŠ¤
  embedding_device: "auto"


# --- RAG íŒŒì´í”„ë¼ì¸ ì„¤ì • ---
rag:
  # ë²¡í„° ì €ì¥ì†Œ ìºì‹œ ë””ë ‰í„°ë¦¬
  vector_store_cache_dir: ".model_cache/vector_store_cache"
  
  # ë¦¬íŠ¸ë¦¬ë²„ ì„¤ì •
  retriever:
    search_type: "similarity"
    search_kwargs:
      k: 5
    # BM25ì™€ FAISSì˜ ê°€ì¤‘ì¹˜
    ensemble_weights: [0.4, 0.6]

  # ì¬ìˆœìœ„í™”(Reranking) ì„¤ì •
  reranker:
    enabled: false
    model_name: "BAAI/bge-reranker-v2-m3" 
    top_k: 6
    bypass_threshold: 0.85
    max_rerank_docs: 12

  # í…ìŠ¤íŠ¸ ë¶„í•  ì„¤ì •
  text_splitter:
    chunk_size: 500
    chunk_overlap: 100
  
  # ì˜ë¯¸ë¡ ì  ë¶„í•  ì„¤ì •
  semantic_chunker:
    enabled: true
    breakpoint_threshold_type: "similarity_threshold"
    breakpoint_threshold_value: 0.6
    sentence_split_regex: "(?<=[.!?])\\s+" # Corrected escape for backslash
    min_chunk_size: 200
    max_chunk_size: 1000
    similarity_threshold: 0.6

  # ì¿¼ë¦¬ í™•ì¥ ì„¤ì •
  query_expansion:
    enabled: true

  # í”„ë¡¬í”„íŠ¸ ì„¤ì •
  prompts:
    # 1. ê³µí†µ ë¶„ì„ ê°€ì´ë“œë¼ì¸ (Common Protocol)
    analysis_protocol: |
      ë‹¹ì‹ ì€ "ì§€ëŠ¥í˜• ë¬¸ì„œ ë¶„ì„ ì¶”ë¡  ëª¨ë¸"ì…ë‹ˆë‹¤. ì œê³µëœ [ë¬¸ì„œ ì»¨í…ìŠ¤íŠ¸]ë¥¼ ë°”íƒ•ìœ¼ë¡œ ë‹¤ìŒì˜ [3ë‹¨ê³„ ë¶„ì„ í”„ë¡œí† ì½œ]ì„ ì¤€ìˆ˜í•˜ì‹­ì‹œì˜¤.

      ### 1ë‹¨ê³„: ì •ë³´ ì‹ ë¢°ì„± ê²€ì¦
      - ì œê³µëœ ì»¨í…ìŠ¤íŠ¸ ë‚´ì— ì§ˆë¬¸ì— ëŒ€í•œ ì§ì ‘ì ì¸ ê·¼ê±°ê°€ ìˆëŠ”ì§€ í™•ì¸í•˜ì‹­ì‹œì˜¤.
      - ê·¼ê±°ê°€ ë¶ˆì¶©ë¶„í•˜ë‹¤ë©´ ì¶”ì¸¡í•˜ì§€ ë§ê³  "í™•ì¸ ê°€ëŠ¥í•œ ì •ë³´ê°€ ë¶€ì¡±í•©ë‹ˆë‹¤"ë¼ê³  ë‹µí•˜ì‹­ì‹œì˜¤.

      ### 2ë‹¨ê³„: ë‹¤ê°ë„ êµì°¨ ë¶„ì„
      - ì—¬ëŸ¬ í˜ì´ì§€ì— ê±¸ì³ ìˆëŠ” ì •ë³´ëŠ” ìƒí˜¸ ì—°ê²°í•˜ì—¬ ì¢…í•©ì ì¸ ê²°ë¡ ì„ ë„ì¶œí•˜ì‹­ì‹œì˜¤.
      - ìˆ˜ì¹˜ë‚˜ ë°ì´í„°ê°€ ì–¸ê¸‰ë  ê²½ìš°, í•´ë‹¹ ìˆ˜ì¹˜ê°€ í¬í•¨ëœ í˜ì´ì§€ [p.X]ë¥¼ ë°˜ë“œì‹œ ëª…ì‹œí•˜ì‹­ì‹œì˜¤.

      ### 3ë‹¨ê³„: ì‘ë‹µ êµ¬ì¡°í™” (Strict Markdown)
      - ì¸ìš© ë°°ì§€: ì‚¬ì‹¤ ì–¸ê¸‰ ì¦‰ì‹œ `[p.X]`ë¥¼ ë¶™ì´ì‹­ì‹œì˜¤. (ì˜ˆ: "A ê¸°ìˆ ì€ B ê³µì •ì„ í†µí•´ ì™„ì„±ë©ë‹ˆë‹¤[p.4].")
      - ì‹œê°ì  ìš”ì†Œ: ë³µì¡í•œ ë‚˜ì—´ì€ ë¶ˆë › í¬ì¸íŠ¸ë¥¼, ë¹„êµ ë°ì´í„°ëŠ” ë§ˆí¬ë‹¤ìš´ í‘œë¥¼ ì‚¬ìš©í•˜ì‹­ì‹œì˜¤.

    # 2. ì˜ë„ë³„ ì‹œìŠ¤í…œ í”„ë¡¬í”„íŠ¸
    research_system_prompt: |
      ë‹¹ì‹ ì€ ì‹¬ì¸µ ë¶„ì„ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì—¬ëŸ¬ ë¬¸ì„œ ì¡°ê°ì„ ì¢…í•©í•˜ì—¬ ì²´ê³„ì ì´ê³  êµ¬ì¡°ì ì¸ ë³´ê³ ì„œ í˜•íƒœë¡œ ë‹µë³€í•˜ì‹­ì‹œì˜¤.
      í˜„ìƒ, ì›ì¸, ê²°ê³¼ ë˜ëŠ” ì¥ë‹¨ì  ë¹„êµë¥¼ í¬í•¨í•˜ì—¬ ì‹¬ë„ ìˆê²Œ ì„¤ëª…í•˜ì‹­ì‹œì˜¤. ì¸ìš© [p.X]ì€ í•„ìˆ˜ì…ë‹ˆë‹¤.

    factoid_system_prompt: |
      ë‹¹ì‹ ì€ ì‚¬ì‹¤ í™•ì¸ ì „ë¬¸ê°€ì…ë‹ˆë‹¤. ì§ˆë¬¸ì— ëŒ€í•´ ë¶ˆí•„ìš”í•œ ì„œìˆ  ì—†ì´ í•µì‹¬ ì‚¬ì‹¤ ìœ„ì£¼ë¡œ ê°„ê²°í•˜ê²Œ ë‹µë³€í•˜ì‹­ì‹œì˜¤.
      ì •í™•í•œ ìˆ˜ì¹˜ë‚˜ ê³ ìœ  ëª…ì‚¬ì— ì§‘ì¤‘í•˜ë©°, ë°˜ë“œì‹œ ì¶œì²˜ í˜ì´ì§€ [p.X]ë¥¼ ëª…ì‹œí•˜ì‹­ì‹œì˜¤.

    greeting_system_prompt: |
      ë‹¹ì‹ ì€ ì¹œì ˆí•œ AI ì–´ì‹œìŠ¤í„´íŠ¸ì…ë‹ˆë‹¤. ì‚¬ìš©ìì˜ ì¸ì‚¬ë‚˜ ì¼ìƒì ì¸ ëŒ€í™”ì— ìì—°ìŠ¤ëŸ½ê³  ë”°ëœ»í•˜ê²Œ ì‘ë‹µí•˜ì„¸ìš”.
      ë¬¸ì„œ ë¶„ì„ ì¤€ë¹„ê°€ ì™„ë£Œë˜ì—ˆë‹¤ë©´ ê´€ë ¨ ì•ˆë‚´ë¥¼ ë§ë¶™ì—¬ë„ ì¢‹ìŠµë‹ˆë‹¤.

    out_of_context_system_prompt: |
      ë‹¹ì‹ ì€ ì •ì§í•œ ë¶„ì„ê´€ì…ë‹ˆë‹¤. ì§ˆë¬¸í•˜ì‹  ë‚´ìš©ì´ í˜„ì¬ ì—…ë¡œë“œëœ ë¬¸ì„œì˜ ë²”ìœ„ë¥¼ ë²—ì–´ë‚˜ ìˆìŒì„ ì •ì¤‘íˆ ì•ˆë‚´í•˜ì‹­ì‹œì˜¤.
      ê°€ëŠ¥í•˜ë‹¤ë©´ ë¬¸ì„œ ë‚´ì—ì„œ ë‹µë³€ ê°€ëŠ¥í•œ ê°€ì¥ ìœ ì‚¬í•œ ì£¼ì œë¥¼ ì œì•ˆí•´ ì£¼ì‹­ì‹œì˜¤.

    # 3. ê¸°ë³¸ í”„ë¡¬í”„íŠ¸ (Fallback)
    qa_system_prompt: |
      ë‹¹ì‹ ì€ [ë¬¸ì„œ ì»¨í…ìŠ¤íŠ¸]ì˜ ë‚´ìš©ì„ ì •êµí•˜ê²Œ ë¶„ì„í•˜ì—¬ ë‹µë³€ì„ êµ¬ì„±í•˜ëŠ” ì „ë¬¸ ë¶„ì„ê´€ì…ë‹ˆë‹¤.
      ë°˜ë“œì‹œ ì œê³µëœ ì»¨í…ìŠ¤íŠ¸ ë‚´ì˜ ì •ë³´ë§Œì„ í™œìš©í•˜ê³ , ì‚¬ì‹¤ì´ ì–¸ê¸‰ë  ë•Œë§ˆë‹¤ í•´ë‹¹ í˜ì´ì§€ ë²ˆí˜¸ `[p.X]`ë¥¼ ì¦‰ì‹œ ë’¤ì— ë¶™ì—¬ì£¼ì„¸ìš”.

    # 4. Human Prompt
    qa_human_prompt: |
      ì œê³µëœ [ë¬¸ì„œ ì»¨í…ìŠ¤íŠ¸]ë¥¼ ë¶„ì„í•˜ì—¬ ì•„ë˜ì˜ [ì§ˆë¬¸]ì— ëŒ€í•´ ë‹µë³€í•˜ì‹­ì‹œì˜¤.

      ### [ë¬¸ì„œ ì»¨í…ìŠ¤íŠ¸] ###
      {context}

      ### [ì§ˆë¬¸] ###
      {input}

    # 3. ì¿¼ë¦¬ í™•ì¥(Multi-Query) í”„ë¡¬í”„íŠ¸
    query_expansion_prompt: |
      ì‚¬ìš©ìì˜ ì§ˆë¬¸ì„ ë¬¸ì„œ ê²€ìƒ‰ì— íš¨ê³¼ì ì¸ 3ê°œì˜ ì§§ì€ ê²€ìƒ‰ì–´ë¡œ ë³€í™˜í•˜ì„¸ìš”.
      - í•œ ì¤„ì— í•˜ë‚˜ì”© ì¶œë ¥
      - ë¶€ê°€ ì„¤ëª… ê¸ˆì§€

# --- ìºì‹œ ë³´ì•ˆ ì„¤ì • ---
cache_security:
  security_level: "medium"
  hmac_secret: null
  trusted_paths:
    - ".model_cache"
  on_validation_failure: "regenerate"
  check_permissions: true
  expected_file_mode: 0o644
  expected_dir_mode: 0o755

# --- ì±„íŒ… UI ì„¤ì • ---
ui:
  container_height: 700
  messages:
    preparing_answer: "ë‹µë³€ ìƒì„± ì¤€ë¹„ ì¤‘..."
    thinking: "ğŸ¤” ìƒê°ì„ ì •ë¦¬í•˜ëŠ” ì¤‘ì…ë‹ˆë‹¤..."
    no_thought_process: "ì•„ì§ ìƒê° ê³¼ì •ì´ ì—†ìŠµë‹ˆë‹¤."
    no_related_info: |
      ì œê³µëœ ë¬¸ì„œì—ì„œ ì§ˆë¬¸ì— ëŒ€í•œ ëª…í™•í•œ ì •ë³´ë¥¼ ì°¾ê¸° ì–´ë µìŠµë‹ˆë‹¤. ğŸ˜¥

      **ë‹¤ìŒì„ ì‹œë„í•´ ë³´ì„¸ìš”:**
      - ì§ˆë¬¸ì„ ì¢€ ë” ëª…í™•í•˜ê²Œ í•˜ê±°ë‚˜ ë‹¤ë¥¸ í‚¤ì›Œë“œë¥¼ ì‚¬ìš©í•´ ë³´ì„¸ìš”.
      - ì¢€ ë” ì¼ë°˜ì ì´ê±°ë‚˜ ë„“ì€ ë²”ìœ„ì˜ ì§ˆë¬¸ì„ í•´ë³´ì„¸ìš”.

    sidebar_title: "âš™ï¸ ì„¤ì •"
    pdf_uploader_label: "PDF íŒŒì¼ ì—…ë¡œë“œ"
    model_selector_label: "ì¶”ë¡  ëª¨ë¸ ì„ íƒ"
    embedding_selector_label: "ì„ë² ë”© ëª¨ë¸ ì„ íƒ"
    system_status_title: "ì‹œìŠ¤í…œ ìƒíƒœ"
    loading_models: "ì¶”ë¡  ëª¨ë¸ ëª©ë¡ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘..."

    pdf_viewer_title: "ğŸ“„ PDF ë¯¸ë¦¬ë³´ê¸°"
    pdf_viewer_no_file: "ë¯¸ë¦¬ë³¼ PDFê°€ ì—†ìŠµë‹ˆë‹¤. ì‚¬ì´ë“œë°”ì—ì„œ íŒŒì¼ì„ ì—…ë¡œë“œí•´ì£¼ì„¸ìš”."
    pdf_viewer_prev_button: "â† ì´ì „"
    pdf_viewer_next_button: "ë‹¤ìŒ â†’"
    pdf_viewer_page_slider: "í˜ì´ì§€ ì´ë™"
    pdf_viewer_error: "PDFë¥¼ í‘œì‹œí•˜ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {e}"

    chat_title: "ğŸ’¬ ì±„íŒ…"
    chat_input_placeholder: "PDF ë‚´ìš©ì— ëŒ€í•´ ì§ˆë¬¸í•´ë³´ì„¸ìš”."
    chat_no_qa_system: "QA ì‹œìŠ¤í…œì´ ì¤€ë¹„ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤. PDFë¥¼ ë¨¼ì € ì²˜ë¦¬í•´ì£¼ì„¸ìš”."
    chat_welcome: |
      **RAG-Chatì— ì˜¤ì‹  ê²ƒì„ í™˜ì˜í•©ë‹ˆë‹¤!**

      ì‚¬ì´ë“œë°”ì—ì„œ PDF íŒŒì¼ì„ ì—…ë¡œë“œí•˜ì—¬ ë¬¸ì„œ ë‚´ìš©ì— ëŒ€í•œ ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”.
    chat_guide: |
      **ğŸ’¡ ì‚¬ìš© ê°€ì´ë“œ**
      - **PDF ì—…ë¡œë“œ:** ì¢Œì¸¡ ì‚¬ì´ë“œë°”ì—ì„œ ë¶„ì„í•˜ê³  ì‹¶ì€ PDFë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”.
      - **ëª¨ë¸ ì„ íƒ:** ë¡œì»¬ ì¶”ë¡  ëª¨ë¸ì„ ì„ íƒí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      - **ì§ˆë¬¸í•˜ê¸°:** ë¬¸ì„œ ì²˜ë¦¬ê°€ ì™„ë£Œë˜ë©´, ë‚´ìš©ì— ëŒ€í•´ ììœ ë¡­ê²Œ ì§ˆë¬¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      - **PDF ë·°ì–´:** ìš°ì¸¡ì—ì„œ ì›ë³¸ ë¬¸ì„œë¥¼ í•¨ê»˜ ë³´ë©° ëŒ€í™”í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      
      **âš ï¸ ì•Œì•„ë‘ì‹¤ ì **
      - **ë‹µë³€ì˜ ì •í™•ì„±:** ë‹µë³€ì€ ì—…ë¡œë“œëœ PDF ë‚´ìš©ë§Œì„ ê¸°ë°˜ìœ¼ë¡œ ìƒì„±ë˜ë©°, ì‚¬ì‹¤ì´ ì•„ë‹ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
      - **ì´ˆê¸° ë¡œë”©:** ì„ë² ë”© ëª¨ë¸ì„ ì²˜ìŒ ì‚¬ìš©í•˜ë©´ ë‹¤ìš´ë¡œë“œì— ëª‡ ë¶„ì´ ì†Œìš”ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    streaming_error: "ìŠ¤íŠ¸ë¦¬ë° ë‹µë³€ ìƒì„± ì¤‘ ì˜¤ë¥˜ ë°œìƒ: {e}"
    generic_error: "ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {error_msg}"
    retry_button: "ì¬ì‹œë„"
    errors:
      ollama_not_running: "Ollama ì„œë²„ì— ì—°ê²°í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ì„œë²„ê°€ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•´ì£¼ì„¸ìš”."